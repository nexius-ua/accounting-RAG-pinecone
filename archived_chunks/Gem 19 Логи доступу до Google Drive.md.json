{
  "filename": "Gem 19 Логи доступу до Google Drive.md",
  "doc_type": "research",
  "total_chunks": 11,
  "created_at": "2025-12-02T16:45:51.648073",
  "status": "archived",
  "chunks": [
    {
      "id": "24441f27883d3d5e",
      "chunk_index": 0,
      "text": "# **Судово-експертний аналіз механізмів аудиту та відстеження подій доступу в хмарному середовищі Google Drive: Порівняльна характеристика Google Workspace Business Starter та приватних облікових записів**\n\n## **1\\. Вступ**\n\nВ епоху цифрової трансформації цілісність даних та підзвітність доступу до них стають фундаментальними стовпами інформаційної безпеки. Питання контролю над тим, хто, коли та на яких правах отримав доступ до конфіденційної інформації, а також коли цей доступ був анульований, є критичним як для корпоративного сектору, так і для приватних користувачів. Хмарні платформи, такі як Google Drive, пропонують різні рівні прозорості в залежності від типу підписки. Цей звіт присвячено глибокому технічному та форензичному (судово-експертному) аналізу можливостей отримання журналів аудиту (логів) щодо подій надання (sharing) та відкликання (revocation) доступу до файлів та папок.\n\nОсоблива увага приділяється двом діаметрально протилежним сценаріям використання: корпоративній підписці початкового рівня **Google Workspace Business Starter** та **приватному (персональному) облікового запису Google**. Мета дослідження — не лише відповісти на питання наявності таких логів, але й розкрити архітектурні, технічні та процедурні нюанси їх отримання, інтерпретації та використання як доказової бази.\n\nДослідження базується на аналізі технічної документації Google Cloud, специфікацій Admin SDK Reports API, практик системного адміністрування та емпіричних даних спільноти експертів з кібербезпеки.\n\n---\n\n## **2\\. Стисле резюме та відповідь на запит**\n\nВідповідно до поставленого завдання, нижче наведено структуровану відповідь у вигляді таблиці, яка синтезує результати дослідження щодо доступності логів розшарення та відкликання доступу.\n\n### **Таблиця 1: Порівняльна характеристика доступності логів доступу**"
    },
    {
      "id": "c44c623406301a4a",
      "chunk_index": 1,
      "text": "| Параметр аудиту | Google Workspace Business Starter | Приватний акаунт Google (Personal) |\n| :---- | :---- | :---- |\n| **Доступність логів розшарення** | **Повна.** Адміністратори мають доступ до подій через Reports API та базові звіти в Admin Console. | **Обмежена (Візуальна).** Доступно лише через інтерфейс \"Activity\" (Активність) у бічній панелі. |\n| **Фіксація події \"Надання доступу\"** | **Так.** Подія change\\_user\\_access із зазначенням new\\_value (наприклад, can\\_view). | **Так.** Запис у стрічці: \"Ви надали доступ...\" (You shared an item...). |\n| **Фіксація події \"Забрання доступу\" (Revocation)** | **Так.** Фіксується як подія зміни ACL, де старе значення прав замінюється на none або видаляється. | **Так.** Запис у стрічці: \"Ви припинили спільний доступ...\" (You stopped sharing...). |\n| **Точність часу (Timestamp)** | **Висока.** Точний час у форматі RFC 3339 (наприклад, 2023-10-27T14:30:05.123Z). | **Низька.** Часто відображається відносний час (\"вчора\", \"2 години тому\"). Точна дата при наведенні курсору. |\n| **Методи експорту даних** | **Автоматизований.** CSV, JSON через API, Google Apps Manager (GAM), або експорт у BigQuery (при налаштуванні). | **Ручний.** Відсутній штатний експорт історії дозволів. Google Takeout не надає деталізованого журналу ACL. |\n| **Глибина історії (Ретенція)** | **180 днів (6 місяців).** Це стандартний ліміт для активних звітів, якщо не налаштовано архівування. | **Невизначена.** Історія зберігається доки існує об'єкт, але старі події важко знайти через інтерфейс (infinite scroll). |\n| **Пошук та фільтрація** | **Можливий.** Пошук за актором, файлом, типом події через API або консоль. | **Неможливий.** Немає функції пошуку по історії змін доступу; лише ручний перегляд. |\n\n---\n\n## **3\\. Частина I: Теоретичні основи та архітектура аудиту в Google Workspace**"
    },
    {
      "id": "a73db225c051d44c",
      "chunk_index": 2,
      "text": "Щоб зрозуміти нюанси отримання логів у пакеті Business Starter, необхідно розглянути, як Google обробляє події на рівні інфраструктури. На відміну від локальних файлових серверів (наприклад, Windows Server), де аудит налаштовується локально, хмарна архітектура Google базується на розподіленій системі Colossus та глобальній системі управління ідентифікацією.\n\n### **3.1. Дихотомія інтерфейсу та даних (UI vs API Gap)**\n\nОднією з ключових знахідок цього дослідження є концепція \"розриву між інтерфейсом та даними\" (UI/API Gap). Маркетингові матеріали Google часто позиціонують \"Розширений аудит\" (Advanced Auditing) як функцію дорожчих тарифів (Standard, Plus, Enterprise).1 Однак, це обмеження часто стосується **інструментарію візуалізації**, а саме \"Security Investigation Tool\" — потужного графічного інтерфейсу для розслідувань.3\n\nРеальність полягає в тому, що на рівні бекенду система Google Workspace **зобов'язана** генерувати логи подій для всіх тарифних планів, включаючи Starter. Це продиктовано необхідністю забезпечення базової функціональності сервісу: система повинна знати поточний стан списків контролю доступу (ACL). Тому, хоча адміністратор Business Starter може не мати красивих дашбордів, він має повний доступ до \"сирих\" даних через Reports API.4 Це фундаментальна відмінність, яку часто ігнорують у поверхневих оглядах.\n\n### **3.2. Структура події аудиту Drive**\n\nКожна дія користувача, пов'язана зі зміною прав доступу, генерує стандартизований запис. Розуміння структури цього запису є критичним для інтерпретації відповіді на запит користувача.\n\nТиповий об'єкт події в логах містить:\n\n* **id**: Унікальний ідентифікатор події та точний час (timestamp).  \n* **actor**: Суб'єкт дії (email користувача, який надав або забрав доступ).  \n* **ipAddress**: IP-адреса, з якої було виконано дію.6  \n* **events**: Масив, що описує конкретну зміну. Для запиту користувача ключовою є подія типу acl\\_change (зміна списку контролю доступу)."
    },
    {
      "id": "4fa92ca0087730d9",
      "chunk_index": 3,
      "text": "У контексті Business Starter ці дані є повністю доступними, що спростовує поширений міф про \"сліпоту\" базових тарифів.\n\n---\n\n## **4\\. Частина II: Google Workspace Business Starter — Глибинний аналіз можливостей**\n\nДля користувачів тарифу Business Starter питання отримання логів є найбільш актуальним, оскільки стандартна консоль адміністратора може виглядати обмеженою.\n\n### **4.1. Доступність логів через Admin Console**\n\nВсупереч деяким твердженням про відсутність аудиту, Google надає адміністраторам Business Starter доступ до розділу \"Звіти\" (Reports).  \nПерейшовши в Menu \\> Reporting \\> Audit and investigation \\> Drive log events (або у старіших версіях інтерфейсу — Reports \\> Audit \\> Drive), адміністратор може побачити список подій.7\n\n#### **Обмеження інтерфейсу Starter:**\n\n1. **Фільтрація:** Можливості фільтрації можуть бути менш гнучкими, ніж у Enterprise версіях. Наприклад, складні запити з логікою \"AND/OR\" можуть бути недоступні.  \n2. **Дії (Remediation):** З цього інтерфейсу може бути неможливо масово скасувати зміни, але можна *побачити*, що зміни відбулися.  \n3. **Затримка (Lag Time):** Інформація може з'являтися із затримкою від кількох хвилин до 24 годин, хоча для подій безпеки Google намагається мінімізувати цей час.3\n\n### **4.2. Reports API: Ключ до повної історії**\n\nДля отримання детальної відповіді на питання \"коли було забрано доступ\", Reports API є безальтернативним інструментом для Business Starter. Цей інтерфейс дозволяє програмно витягувати історію подій.\n\n#### **Аналіз події \"Відкликання доступу\" (Revocation)**\n\nКоли користувач забирає доступ до папки, API генерує подію change\\_user\\_access (або change\\_document\\_access для публічних посилань).  \nУ структурі відповіді JSON це виглядає наступним чином:"
    },
    {
      "id": "b30ac932f99abbfe",
      "chunk_index": 4,
      "text": "* **Назва події:** change\\_user\\_access  \n* **Параметр target\\_user:** (Email особи, у якої забрали доступ, наприклад, outsider@gmail.com)  \n* **Параметр old\\_value:** can\\_view (або can\\_edit)  \n* **Параметр new\\_value:** none (або відсутність цього параметра, що також сигналізує про видалення прав).\n\nНаявність пари значень old\\_value та new\\_value дає чітку відповідь на питання користувача: ми точно знаємо, який рівень доступу був раніше, і що тепер він відсутній. Час цієї події (timestamp) фіксує момент \"забрання\".\n\n### **4.3. Ретенція даних (Data Retention)**\n\nКритичним аспектом є те, як довго зберігаються ці логи. Для Business Starter (як і для більшості тарифів Workspace) стандартний період зберігання активних логів у Reports API становить 180 днів (6 місяців).3  \nЦе означає:\n\n* Якщо доступ було забрано 3 місяці тому, ви знайдете цей запис.  \n* Якщо доступ було забрано 8 місяців тому, запис, ймовірно, вже видалено з оперативних логів, якщо організація не налаштувала експорт логів у Google Cloud (BigQuery) або сторонню SIEM-систему.\n\n**Інсайт:** Для організацій на Business Starter критично важливо налаштувати автоматичний експорт логів, якщо їм потрібна історія довша за півроку, оскільки \"коробкове\" рішення не зберігає дані довше.\n\n---\n\n## **5\\. Частина III: Приватний акаунт Google (Personal) — Аналіз \"сліпої зони\"**\n\nСитуація з приватними акаунтами (@gmail.com) є кардинально іншою і демонструє суттєві обмеження для проведення розслідувань.\n\n### **5.1. Візуальна панель \"Активність\" (Activity Stream)**\n\nЄдиним штатним інструментом для перегляду історії доступу в приватному акаунті є панель \"Деталі\" (View Details), яка викликається натисканням іконки (i) у веб\\-інтерфейсі Drive.9\n\n#### **Характеристики та недоліки:**"
    },
    {
      "id": "24916b553a59ca2f",
      "chunk_index": 5,
      "text": "1. **Лінійність та відсутність пошуку:** Це просто хронологічний список усіх дій з файлом або папкою. Якщо папка існує кілька років і в ній активно працюють, знайти подію \"забрання доступу\" річної давнини вимагатиме нескінченного прокручування (infinite scroll). Пошук (Ctrl+F) працює тільки по підвантажених елементах.  \n2. **Нечіткість часових міток:** Інтерфейс оптимізовано для зручності (\"user-friendly\"), а не для точності. Записи часто групуються: \"Ви та ще 2 користувачі редагували цей файл минулого тижня\". Щоб побачити точний час надання або забрання доступу, потрібно наводити курсор на конкретний запис, що унеможливлює автоматизований аналіз.  \n3. **Ефемерність контексту:** Якщо файл видаляється, доступ до його історії через інтерфейс втрачається. Якщо користувач втрачає права на папку, він також втрачає доступ до перегляду її історії активності.\n\n### **5.2. Проблема Google Takeout та activity.json**\n\nКористувачі часто сподіваються, що сервіс вивантаження даних Google Takeout 11 надасть їм \"чорну скриньку\" з логами. Аналіз показав, що це не так.\n\n* Файл activity.json, який можна отримати через Takeout (розділ \"My Activity\"), фокусується на поведінці власника акаунту як споживача контенту (що шукав, які сайти відвідував, які відео дивився).12  \n* Він **не містить** структурованого журналу змін ACL (Access Control List) для файлів Drive. Тобто, ви не знайдете там таблиці: \"Дата: 01.01.2023, Дія: Revoke, User: user@example.com\".  \n* Експорт Drive через Takeout надає самі файли, а не метадані їхнього історичного доступу.\n\n**Висновок для приватних акаунтів:** Отримати *лог* у технічному розумінні (файлом або таблицею) неможливо. Можна лише вручну зібрати інформацію шляхом візуального огляду, що є неприйнятним для масштабних задач, але єдиним виходом для точкової перевірки.\n\n---\n\n## **6\\. Частина IV: Технічні методи вилучення даних (Практичний посібник)**"
    },
    {
      "id": "1e99510a5bd0ff36",
      "chunk_index": 6,
      "text": "Для адміністраторів Business Starter існує можливість обійти обмеження інтерфейсу і отримати дані у вигляді, придатному для аудиту (таблиці).\n\n### **6.1. Використання GAM (Google Apps Manager)**\n\nGAM — це інструмент командного рядка, який використовує Admin SDK API і є стандартом де\\-факто для професійного адміністрування Workspace. Він працює на всіх тарифах, включаючи Starter.\n\nДля отримання логів розшарення та відкликання доступу використовується наступна команда:\n\nBash\n\ngam report drive user all filter \"event\\_name==change\\_user\\_access\" start \"2023-01-01\" \\> drive\\_audit.csv\n\n**Розбір команди:**\n\n* report drive: звертається до Reports API.  \n* user all: сканує дії всіх користувачів в домені.  \n* filter \"event\\_name==change\\_user\\_access\": відсіює зайві події (редагування, перегляд), залишаючи тільки зміни прав доступу.  \n* start \"...\": задає початкову дату пошуку.\n\nОтриманий CSV-файл міститиме колонки parameters.target\\_user, parameters.old\\_value та parameters.new\\_value.\n\n* Якщо old\\_value \\= can\\_view і new\\_value \\= none (або порожньо), це і є шукана подія **\"коли це було забрано\"**.\n\n### **6.2. Google Sheets \\+ Apps Script**\n\nДля адміністраторів Business Starter, які не можуть використовувати командний рядок, можливо написати скрипт на Google Apps Script, який звертатиметься до сервісу AdminReports.  \nСкрипт може автоматично витягувати події за останній тиждень і записувати їх у Google Таблицю. Це повністю вирішує задачу користувача щодо отримання даних \"у вигляді таблиці\".  \n**Приклад логіки скрипта:**\n\n1. Викликати AdminReports.Activities.list('all', 'drive', {eventName: 'change\\_user\\_access'}).  \n2. Ітерувати через масив items.  \n3. Для кожного елемента витягувати id.time (час) та параметри зміни прав.  \n4. Записувати рядок у таблицю.\n\nЦей метод є безкоштовним і доступним на Starter.\n\n---\n\n## **7\\. Частина V: Порівняльний аналіз безпеки та ризиків**\n\n### **7.1. Ризик інсайдерських загроз**\n\nРізниця в доступності логів створює різний профіль ризику."
    },
    {
      "id": "1bbd68d83f376d74",
      "chunk_index": 7,
      "text": "* **Business Starter:** Адміністратор має \"всевидяче око\" завдяки API. Якщо співробітник вирішить скопіювати базу даних клієнтів, надавши доступ на свій приватний акаунт, а потім забере цей доступ, щоб \"замести сліди\", **лог залишиться**. Адміністратор зможе довести факт порушення, витягнувши подію з API, навіть якщо в інтерфейсі вона вже не відображається явно.  \n* **Приватний акаунт:** Якщо власник приватного акаунту надав доступ комусь, а потім забрав, і згодом забув про це, відновити хронологію буде вкрай важко. Це створює ілюзію приватності, але також і ризик безконтрольного поширення даних.\n\n### **7.2. \"Спільні диски\" (Shared Drives) у Starter**\n\nВажливим оновленням для Business Starter стала поява підтримки Shared Drives (раніше Team Drives).1 Це суттєво покращує аудит. Логи Shared Drives не прив'язані до індивідуального користувача, а до самого диску. Це означає, що навіть якщо співробітник, який надав доступ, був звільнений і його акаунт видалений, історія змін ACL на спільних дисках залишається доступною для аудиту.\n\n---\n\n## **8\\. Висновки**\n\nПроведене дослідження дозволяє зробити однозначні висновки щодо можливості отримання логів доступу."
    },
    {
      "id": "ba76570af102d775",
      "chunk_index": 8,
      "text": "1. **Для Google Workspace Business Starter:** Відповідь — **ТАК**. Незважаючи на спрощений інтерфейс адміністратора, організація володіє повним контролем над даними аудиту. Використовуючи Reports API або інструменти на кшталт GAM, можна отримати точну хронологічну таблицю подій надання та відкликання доступу із зазначенням конкретних email-адрес та часу з точністю до секунди. Технічний бар'єр полягає лише у необхідності використання зовнішніх інструментів для візуалізації цих даних.  \n2. **Для приватних акаунтів:** Відповідь — **ТАК, АЛЕ З СУТТЄВИМИ ОБМЕЖЕННЯМИ**. Логи існують лише у вигляді візуальної стрічки активності. Отримати їх у вигляді структурованої таблиці для експорту неможливо без використання складних технік скрапінгу екрану (screen scraping) або ручного переписування даних. Це робить приватні акаунти непридатними для сценаріїв, де вимагається суворий аудит та підзвітність.\n\n**Рекомендація:** Для будь-якої діяльності, що вимагає підзвітності доступу до даних, використання навіть найдешевшого тарифу Business Starter є критично необхідним у порівнянні з безкоштовними акаунтами, саме завдяки наявності API доступу до журналів аудиту.\n\n#### **Джерела** 1. Google Workspace Business Starter vs Standard Dubai UAE \\- XL Technologies, доступ отримано грудня 1, 2025, [https://xltechglobal.com/blog/google-workspace/google-workspace-business-starter-vs-standard-which-one-to-choose/](https://xltechglobal.com/blog/google-workspace/google-workspace-business-starter-vs-standard-which-one-to-choose/)  \n2. Google Workspace Editions \\- HiView Solutions, доступ отримано грудня 1, 2025, [https://hiviewsolutions.com/editioncomparison/](https://hiviewsolutions.com/editioncomparison/)  \n3. Drive log events \\- Google Workspace Admin Help, доступ отримано грудня 1, 2025, [https://support.google.com/a/answer/4579696?hl=en](https://support.google.com/a/answer/4579696?hl=en)  \n4."
    },
    {
      "id": "8b51668871880a72",
      "chunk_index": 9,
      "text": "Reports API: Drive Activity Report | Admin console \\- Google for Developers, доступ отримано грудня 1, 2025, [https://developers.google.com/workspace/admin/reports/v1/guides/manage-audit-drive](https://developers.google.com/workspace/admin/reports/v1/guides/manage-audit-drive)  \n5. Inconsistent documentation for Business Starter plan on receiving Drive log events, доступ отримано грудня 1, 2025, [https://support.google.com/a/thread/255569984/inconsistent-documentation-for-business-starter-plan-on-receiving-drive-log-events?hl=en](https://support.google.com/a/thread/255569984/inconsistent-documentation-for-business-starter-plan-on-receiving-drive-log-events?hl=en)  \n6. Method: activities.list | Admin console \\- Google for Developers, доступ отримано грудня 1, 2025, [https://developers.google.com/workspace/admin/reports/reference/rest/v1/activities/list](https://developers.google.com/workspace/admin/reports/reference/rest/v1/activities/list)  \n7. View and manage audit logs for Google Workspace | Cloud Logging, доступ отримано грудня 1, 2025, [https://docs.cloud.google.com/logging/docs/audit/configure-gsuite-audit-logs](https://docs.cloud.google.com/logging/docs/audit/configure-gsuite-audit-logs)  \n8. Admin log events \\- Google Workspace Admin Help, доступ отримано грудня 1, 2025, [https://support.google.com/a/answer/4579579?hl=en](https://support.google.com/a/answer/4579579?hl=en)  \n9. How to See Who Accessed Your Google Drive Files (Docs, Sheets, and Slides) \\- PureVPN, доступ отримано грудня 1, 2025, [https://www.purevpn.com/blog/who-accessed-your-google-drive-files/](https://www.purevpn.com/blog/who-accessed-your-google-drive-files/)  \n10. I have had a google drive folder of very important to me “sensitive” photos go missing, доступ отримано грудня 1, 2025, [https://www.reddit.com/r/techsupport/comments/1ou3qcr/i\\_have\\_had\\_a\\_google\\_drive\\_folder\\_of\\_very/](https://www.reddit.com/r/techsupport/comments/1ou3qcr/i_have_had_a_google_drive_folder_of_very/)  \n11."
    },
    {
      "id": "7b43052a1f2b1248",
      "chunk_index": 10,
      "text": "How to download your Google data \\- Google Account Help, доступ отримано грудня 1, 2025, [https://support.google.com/accounts/answer/3024190?hl=en](https://support.google.com/accounts/answer/3024190?hl=en)  \n12. How to download all your Google Search queries and analyze them \\- Kevin Simper, доступ отримано грудня 1, 2025, [https://www.kevinsimper.dk/posts/how-to-download-all-your-google-search-queries](https://www.kevinsimper.dk/posts/how-to-download-all-your-google-search-queries)  \n13. Alternative to \"My Google Activity\" : r/degoogle \\- Reddit, доступ отримано грудня 1, 2025, [https://www.reddit.com/r/degoogle/comments/1jdnqib/alternative\\_to\\_my\\_google\\_activity/](https://www.reddit.com/r/degoogle/comments/1jdnqib/alternative_to_my_google_activity/)"
    }
  ],
  "archived_at": "2025-12-02T16:45:54.803721"
}